<h1 id="i-v-i">i++ vÃ  ++i</h1>
<p><div class='published'><b>Published:</b> 2018-06-22 20:20:20</div></p>

<p>MÃ¬nh nhá»› há»“i phá»ng váº¥n vÃ o cty, cÃ³ má»™t bÃ i test code vá» vÃ²ng láº·p, cÃ¡i <code>for</code> nÃ o mÃ¬nh cÅ©ng xÃ i <code>++i</code>. Sáº¿p tháº¯c máº¯c 2 3 láº§n sao khÃ´ng dÃ¹ng <code>i++</code> nhÆ°ng mÃ¬nh cá»© vÃ²ng vo lÃ  &quot;it&#39;s faster but I forgot the reason&quot;. May sao lÃ£o sáº¿p hÃ¬nh nhÆ° cÅ©ng cháº£ biáº¿t cÃ¢u tráº£ lá»i nÃªn tá»± Ã¡i mÃ  cho mÃ¬nh pass ğŸ˜‚. CÆ¡ mÃ  mÃ£i Ä‘áº¿n bÃ¢y giá» ngá»“i há»“i tÆ°á»Ÿng láº¡i mÃ  mÃ¬nh cÅ©ng chÆ°a nhá»› ra cÃ¡i nguyÃªn nhÃ¢n Ä‘Ã³, nÃªn tá»‘i vá» há»i láº¡i gugo-sama ngay vÃ  viáº¿t bÃ i nÃ y.</p>
<h2 id="-i-m-kh-c-bi-t">Äiá»ƒm khÃ¡c biá»‡t</h2>
<p>KhÃ¡c biá»‡t cÆ¡ báº£n nÃ y Ã¡p dá»¥ng cho háº§u háº¿t cÃ¡c ngÃ´n ngá»¯ vÃ  compiler hiá»‡n nay.</p>
<pre><code class="lang-C++">int a=0, b=0;
a++; // a = 1
++b; // b = 1
b = ++a; // b = a = 2
a = b++; // a = 2, b = 3
</code></pre>
<p><code>++i</code> tÄƒng giÃ¡ trá»‹ cá»§a <strong>i</strong> lÃªn 1 vÃ  tráº£ vá» giÃ¡ trá»‹ má»›i Ä‘Ã³.<br> 
<code>i++</code> cÅ©ng tÆ°Æ¡ng tá»± nhÆ°ng giÃ¡ trá»‹ tráº£ vá» lÃ  giÃ¡ trá»‹ ban Ä‘áº§u cá»§a <strong>i</strong> trÆ°á»›c khi Ä‘Æ°á»£c tÄƒng lÃªn 1.</p>
<p>Má»™t Ä‘iá»ƒm Ä‘Ã¡ng lÆ°u Ã½ á»Ÿ Ä‘Ã¢y, khÃ´ng nÃªn nháº§m láº«n lÃ  <code>i++</code> sáº½ tráº£ vá» giÃ¡ trá»‹ <strong>i</strong> cho phÃ©p gÃ¡n trÆ°á»›c khi nÃ³ Ä‘Æ°á»£c tÄƒng lÃªn. PhÃ©p gÃ¡n luÃ´n thá»±c hiá»‡n sau cÃ¹ng, nÃªn Ä‘iá»u Ä‘Ã³ lÃ  khÃ´ng thá»ƒ nhÃ©.</p>
<p>Vá» báº£n cháº¥t chÆ°Æ¡ng trÃ¬nh sáº½ táº¡o ra má»™t biáº¿n táº¡m (temp) Ä‘á»ƒ lÆ°u giÃ¡ trá»‹ ban Ä‘áº§u cá»§a <strong>i</strong> vÃ  tráº£ vá» giÃ¡ trá»‹ Ä‘Ã³ cho phÃ©p gÃ¡n sau khi phÃ©p toÃ¡n <code>i++</code> thá»±c hiá»‡n xong.</p>
<pre><code class="lang-C++">int MePlusPlus(int&amp; me) 
{
    int temp = me;
    me = me + 1;
    return temp;
}
</code></pre>
<h2 id="performance">Performance</h2>
<p>Tuy pháº£i tá»‘n cÃ´ng táº¡o má»™t biáº¿n temp cho <code>i++</code> nhÆ°ng thá»±c táº¿ sá»± khÃ¡c biá»‡t vá» performance lÃ  khÃ´ng lá»›n. Háº§u nhÆ° táº¥t cáº£ compiler hiá»‡n Ä‘áº¡i sáº½ optimize phÃ©p toÃ¡n Ä‘Ã³. Báº±ng chá»©ng lÃ  trong vÃ­ dá»¥ <a href="https://stackoverflow.com/questions/24886/is-there-a-performance-difference-between-i-and-i-in-c/24887#24887">nÃ y</a> trÃªn stackoverflow, <strong>gcc</strong> cho káº¿t quáº£ biÃªn dá»‹ch lÃ  nhÆ° nhau cho hai file code chá»©a vÃ²ng láº·p xÃ i <code>++i</code> vÃ  <code>i++</code>.</p>
<p>NhÆ°ng riÃªng vá»›i <code>C++</code>, sá»± chÃªnh lá»‡ch cÃ³ thá»ƒ lÃ  Ä‘Ã¡ng ká»ƒ trong má»™t sá»‘ trÆ°á»ng há»£p. Cá»¥ thá»ƒ lÃ  vá»›i user-defined type, tá»©c lÃ  <code>class</code> báº¡n táº¡o ra, vÃ¬ <code>operator++()</code> lÃ  má»™t hÃ m vÃ  compiler khÃ´ng biáº¿t lÃ m cÃ¡ch nÃ o Ä‘á»ƒ optimize viá»‡c táº¡o ra cÃ¡i temp object trong Ä‘Ã³ cáº£. Sao nÃ³ biáº¿t Ä‘Æ°á»£c báº¡n define cÃ¡i gÃ¬ vÃ  sáº½ bá»± cá»¡ nÃ o trong class.</p>
<h2 id="v-y-n-n-x-i-c-i-n-o-trong-v-ng-for-">Váº­y nÃªn xÃ i cÃ¡i nÃ o trong vÃ²ng <code>for</code>?</h2>
<p>RiÃªng Ä‘á»‘i vá»›i mÃ¬nh thÃ¬ <code>++i</code> Ä‘Ã£ trá»Ÿ thÃ nh má»™t convention báº¥t thÃ nh vÄƒn rá»“i. DÃ¹ chiáº¿n project nÃ o mÃ¬nh cÅ©ng xÃ i nÃ³ mÃ  cháº£ quan tÃ¢m performance gÃ¬ cho má»‡t Ã³c. Ráº¥t nhiá»u guru trong giá»›i coder Ä‘á»u Ä‘Æ°a ra lá»i khuyÃªn:</p>
<blockquote>
<p>In any case, follow the guideline &quot;prefer ++i over i++&quot; and you won&#39;t go wrong </p>
</blockquote>
<p>(from many Khuyáº¿t Danh)</p>
<h2 id="m-t-ch-t-v-side-effect-v-undefined-behavior">Má»™t chÃºt vá» side effect vÃ  undefined behavior</h2>
<h3 id="v-d-1-">VÃ­ dá»¥ 1:</h3>
<pre><code class="lang-C++">int add(int x, int y)
{
    return x + y;
}

int main()
{
    int x = 5;
    // tÃ¹y thuá»™c vÃ o thá»© tá»± evaluate cÃ¡c param cá»§a conmpiler
    // mÃ  phÃ©p cá»™ng nÃ y cÃ³ thá»ƒ lÃ  5+6 hoáº·c 6+6
    int value = add(x, ++x); 

    std::cout &lt;&lt; value; // 11 or 12?
    return 0;
}
</code></pre>
<h3 id="v-d-2-">VÃ­ dá»¥ 2:</h3>
<pre><code class="lang-C++">int main()
{
    int arr[3] = {0, 1, 2};
    int i = 0;

    arr[i++] = ++i;
    int x = ++i + ++i;

    std::cout &lt;&lt; arr[i] &lt;&lt; endl;
    std::cout &lt;&lt; x; 
    return 0;
}
</code></pre>
<p>MÃ¬nh sáº½ khÃ´ng giáº£i thÃ­ch &quot;Side effect hay UB lÃ  gÃ¬?&quot; á»Ÿ Ä‘Ã¢y. Topic nÃ y cÅ©ng khÃ¡ thÃº vá»‹ nÃªn mÃ¬nh sáº½ viáº¿t riÃªng má»™t bÃ i vá» nÃ³. NhÆ°ng qua hai vÃ­ dá»¥ trÃªn cháº¯c báº¡n cÅ©ng tháº¥y Ä‘Æ°á»£c sá»± nguy hiá»ƒm cá»§a chÃºng, náº¿u phÃ©p gÃ¡n thá»© nháº¥t á»Ÿ vÃ­ dá»¥ 2 mÃ  trong vÃ²ng láº·p ná»¯a thÃ¬ ğŸ˜¨.</p>
<p>Háº¹n gáº·p cÃ¡c báº¡n á»Ÿ nhá»¯ng bÃ i viáº¿t sau!</p>
